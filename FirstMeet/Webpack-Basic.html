<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Webpack基本配置 | XIAOKEDADA</title>
    <meta name="description" content="Write something useful and funny">
    <link rel="icon" href="/xiaokedada/favicon.png">
    
    <link rel="preload" href="/xiaokedada/assets/css/118.styles.306d23a5.css" as="style"><link rel="preload" href="/xiaokedada/assets/js/app.51d0a681.js" as="script"><link rel="preload" href="/xiaokedada/assets/js/76.f1760c70.js" as="script"><link rel="prefetch" href="/xiaokedada/assets/js/0.1bd12f53.js"><link rel="prefetch" href="/xiaokedada/assets/js/1.cd946af2.js"><link rel="prefetch" href="/xiaokedada/assets/js/2.ca24feb6.js"><link rel="prefetch" href="/xiaokedada/assets/js/3.5dbaa314.js"><link rel="prefetch" href="/xiaokedada/assets/js/4.65842a86.js"><link rel="prefetch" href="/xiaokedada/assets/js/5.2706d991.js"><link rel="prefetch" href="/xiaokedada/assets/js/6.a9fa93eb.js"><link rel="prefetch" href="/xiaokedada/assets/js/7.07a04857.js"><link rel="prefetch" href="/xiaokedada/assets/js/8.2e73814c.js"><link rel="prefetch" href="/xiaokedada/assets/js/9.9a4ab9ea.js"><link rel="prefetch" href="/xiaokedada/assets/js/10.1579390c.js"><link rel="prefetch" href="/xiaokedada/assets/js/11.86a2e0ac.js"><link rel="prefetch" href="/xiaokedada/assets/js/12.86d07ec2.js"><link rel="prefetch" href="/xiaokedada/assets/js/13.51025cd6.js"><link rel="prefetch" href="/xiaokedada/assets/js/14.723e0304.js"><link rel="prefetch" href="/xiaokedada/assets/js/15.e05c4533.js"><link rel="prefetch" href="/xiaokedada/assets/js/16.4c1175d0.js"><link rel="prefetch" href="/xiaokedada/assets/js/17.6ea7b9a7.js"><link rel="prefetch" href="/xiaokedada/assets/js/18.743491d2.js"><link rel="prefetch" href="/xiaokedada/assets/js/19.c009a8b2.js"><link rel="prefetch" href="/xiaokedada/assets/js/20.4676c2fd.js"><link rel="prefetch" href="/xiaokedada/assets/js/21.ba3174cf.js"><link rel="prefetch" href="/xiaokedada/assets/js/22.68278222.js"><link rel="prefetch" href="/xiaokedada/assets/js/23.c34c06a8.js"><link rel="prefetch" href="/xiaokedada/assets/js/24.d735d321.js"><link rel="prefetch" href="/xiaokedada/assets/js/25.640616f1.js"><link rel="prefetch" href="/xiaokedada/assets/js/26.7712c941.js"><link rel="prefetch" href="/xiaokedada/assets/js/27.183b317a.js"><link rel="prefetch" href="/xiaokedada/assets/js/28.72e53d68.js"><link rel="prefetch" href="/xiaokedada/assets/js/29.906421b2.js"><link rel="prefetch" href="/xiaokedada/assets/js/30.6e4aa06d.js"><link rel="prefetch" href="/xiaokedada/assets/js/31.b1150a91.js"><link rel="prefetch" href="/xiaokedada/assets/js/32.4a8d2fb5.js"><link rel="prefetch" href="/xiaokedada/assets/js/33.697a833c.js"><link rel="prefetch" href="/xiaokedada/assets/js/34.c414b291.js"><link rel="prefetch" href="/xiaokedada/assets/js/35.e321123d.js"><link rel="prefetch" href="/xiaokedada/assets/js/36.07df1a33.js"><link rel="prefetch" href="/xiaokedada/assets/js/37.c2092f91.js"><link rel="prefetch" href="/xiaokedada/assets/js/38.e999f6e6.js"><link rel="prefetch" href="/xiaokedada/assets/js/39.4ad0eec3.js"><link rel="prefetch" href="/xiaokedada/assets/js/40.15c13f22.js"><link rel="prefetch" href="/xiaokedada/assets/js/41.12d9540b.js"><link rel="prefetch" href="/xiaokedada/assets/js/42.048a5c79.js"><link rel="prefetch" href="/xiaokedada/assets/js/43.23a0cac2.js"><link rel="prefetch" href="/xiaokedada/assets/js/44.e552c633.js"><link rel="prefetch" href="/xiaokedada/assets/js/45.347f0a95.js"><link rel="prefetch" href="/xiaokedada/assets/js/46.59bb9a80.js"><link rel="prefetch" href="/xiaokedada/assets/js/47.0a72aee1.js"><link rel="prefetch" href="/xiaokedada/assets/js/48.32c141f4.js"><link rel="prefetch" href="/xiaokedada/assets/js/49.3610d444.js"><link rel="prefetch" href="/xiaokedada/assets/js/50.350e5049.js"><link rel="prefetch" href="/xiaokedada/assets/js/51.d01155cb.js"><link rel="prefetch" href="/xiaokedada/assets/js/52.a5015ced.js"><link rel="prefetch" href="/xiaokedada/assets/js/53.7b73d8b1.js"><link rel="prefetch" href="/xiaokedada/assets/js/54.092ee587.js"><link rel="prefetch" href="/xiaokedada/assets/js/55.9a2f189a.js"><link rel="prefetch" href="/xiaokedada/assets/js/56.27e46b17.js"><link rel="prefetch" href="/xiaokedada/assets/js/57.d080c747.js"><link rel="prefetch" href="/xiaokedada/assets/js/58.2364eb76.js"><link rel="prefetch" href="/xiaokedada/assets/js/59.9deb8139.js"><link rel="prefetch" href="/xiaokedada/assets/js/60.387795af.js"><link rel="prefetch" href="/xiaokedada/assets/js/61.3d0b8582.js"><link rel="prefetch" href="/xiaokedada/assets/js/62.f5702f6b.js"><link rel="prefetch" href="/xiaokedada/assets/js/63.6e8cc274.js"><link rel="prefetch" href="/xiaokedada/assets/js/64.59692959.js"><link rel="prefetch" href="/xiaokedada/assets/js/65.642d2089.js"><link rel="prefetch" href="/xiaokedada/assets/js/66.515778c0.js"><link rel="prefetch" href="/xiaokedada/assets/js/67.09fd142a.js"><link rel="prefetch" href="/xiaokedada/assets/js/68.d2fd2b20.js"><link rel="prefetch" href="/xiaokedada/assets/js/69.54b34dff.js"><link rel="prefetch" href="/xiaokedada/assets/js/70.08cfd9f1.js"><link rel="prefetch" href="/xiaokedada/assets/js/71.8af3cac6.js"><link rel="prefetch" href="/xiaokedada/assets/js/72.8cf1ac97.js"><link rel="prefetch" href="/xiaokedada/assets/js/73.0d2c3de9.js"><link rel="prefetch" href="/xiaokedada/assets/js/74.c5383443.js"><link rel="prefetch" href="/xiaokedada/assets/js/75.b692daea.js"><link rel="prefetch" href="/xiaokedada/assets/js/77.024d7794.js"><link rel="prefetch" href="/xiaokedada/assets/js/78.54101d27.js"><link rel="prefetch" href="/xiaokedada/assets/js/79.395e6dea.js"><link rel="prefetch" href="/xiaokedada/assets/js/80.3e659e88.js"><link rel="prefetch" href="/xiaokedada/assets/js/81.31d7c9c5.js"><link rel="prefetch" href="/xiaokedada/assets/js/82.76901e43.js"><link rel="prefetch" href="/xiaokedada/assets/js/83.86b6f686.js"><link rel="prefetch" href="/xiaokedada/assets/js/84.e08c1f31.js"><link rel="prefetch" href="/xiaokedada/assets/js/85.a28700bf.js"><link rel="prefetch" href="/xiaokedada/assets/js/86.57747352.js"><link rel="prefetch" href="/xiaokedada/assets/js/87.6495c6ae.js"><link rel="prefetch" href="/xiaokedada/assets/js/88.fe6c9a90.js"><link rel="prefetch" href="/xiaokedada/assets/js/89.48f45856.js"><link rel="prefetch" href="/xiaokedada/assets/js/90.c2c96eb9.js"><link rel="prefetch" href="/xiaokedada/assets/js/91.466b65d5.js"><link rel="prefetch" href="/xiaokedada/assets/js/92.2c835547.js"><link rel="prefetch" href="/xiaokedada/assets/js/93.d0f32c26.js"><link rel="prefetch" href="/xiaokedada/assets/js/94.6d7ef6f7.js"><link rel="prefetch" href="/xiaokedada/assets/js/95.efa056b8.js"><link rel="prefetch" href="/xiaokedada/assets/js/96.1a9f1737.js"><link rel="prefetch" href="/xiaokedada/assets/js/97.68765c16.js"><link rel="prefetch" href="/xiaokedada/assets/js/98.c65e6193.js"><link rel="prefetch" href="/xiaokedada/assets/js/99.734ab7e3.js"><link rel="prefetch" href="/xiaokedada/assets/js/100.ffb81130.js"><link rel="prefetch" href="/xiaokedada/assets/js/101.52409c86.js"><link rel="prefetch" href="/xiaokedada/assets/js/102.2b0d4b0d.js"><link rel="prefetch" href="/xiaokedada/assets/js/103.ecdf3ea3.js"><link rel="prefetch" href="/xiaokedada/assets/js/104.d991dc2b.js"><link rel="prefetch" href="/xiaokedada/assets/js/105.6a089ee7.js"><link rel="prefetch" href="/xiaokedada/assets/js/106.826b0deb.js"><link rel="prefetch" href="/xiaokedada/assets/js/107.6306b794.js"><link rel="prefetch" href="/xiaokedada/assets/js/108.dc62e716.js"><link rel="prefetch" href="/xiaokedada/assets/js/109.18b18713.js"><link rel="prefetch" href="/xiaokedada/assets/js/110.b5de4946.js"><link rel="prefetch" href="/xiaokedada/assets/js/111.fea6ceb6.js"><link rel="prefetch" href="/xiaokedada/assets/js/112.c1b52e48.js"><link rel="prefetch" href="/xiaokedada/assets/js/113.660b807b.js"><link rel="prefetch" href="/xiaokedada/assets/js/114.37c0dee4.js"><link rel="prefetch" href="/xiaokedada/assets/js/115.22f7ee1d.js"><link rel="prefetch" href="/xiaokedada/assets/js/116.8b3a33cc.js"><link rel="prefetch" href="/xiaokedada/assets/js/117.8f39d356.js">
    <link rel="stylesheet" href="/xiaokedada/assets/css/118.styles.306d23a5.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/xiaokedada/" class="home-link router-link-active"><!----><span class="site-name">
      XIAOKEDADA
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/xiaokedada/Blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/xiaokedada/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/xiaokedada/React/" class="nav-link">React</a></div><div class="nav-item"><a href="/xiaokedada/FirstMeet/" class="nav-link router-link-active">More</a></div><div class="nav-item"><a href="/xiaokedada/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/xiaokedada/ReadingNote/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/xiaokedada/Weekly/" class="nav-link">Weekly</a></div><div class="nav-item"><a href="/xiaokedada/GatherAll/" class="nav-link">R &amp; T</a></div><a href="https://github.com/maoxiaoke/xiaokedada" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/xiaokedada/Blog/" class="nav-link">Blog</a></div><div class="nav-item"><a href="/xiaokedada/JavaScript/" class="nav-link">JavaScript</a></div><div class="nav-item"><a href="/xiaokedada/React/" class="nav-link">React</a></div><div class="nav-item"><a href="/xiaokedada/FirstMeet/" class="nav-link router-link-active">More</a></div><div class="nav-item"><a href="/xiaokedada/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/xiaokedada/ReadingNote/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/xiaokedada/Weekly/" class="nav-link">Weekly</a></div><div class="nav-item"><a href="/xiaokedada/GatherAll/" class="nav-link">R &amp; T</a></div><a href="https://github.com/maoxiaoke/xiaokedada" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading open"><span>First-Meet Series</span><!----></p><ul class="sidebar-group-items"><li><a href="/xiaokedada/FirstMeet/First-Meet-JSON.html" class="sidebar-link">JSON 必知必会</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-Cache.html" class="sidebar-link">Web缓存知多少(缓存机制和数据存储)</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-Flux.html" class="sidebar-link">Flux 学习</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-TypeScript.html" class="sidebar-link">TypeScript 通识</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-Webpack.html" class="sidebar-link">新学 Webpack</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-JavaScript.html" class="sidebar-link">JavaScript 一些奇怪的地方</a></li><li><a href="/xiaokedada/FirstMeet/First-Meet-NestJS.html" class="sidebar-link">NestJS 之道</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>All About Vue</span><!----></p><ul class="sidebar-group-items"><li><a href="/xiaokedada/FirstMeet/First-Meet-Vue-Communication.html" class="sidebar-link">解锁 vue2.0 通信的各种姿势</a></li><li><a href="/xiaokedada/FirstMeet/How-To-Write-Vue.html" class="sidebar-link">开发中遇到的 vue 的使用记录一下</a></li><li><a href="/xiaokedada/FirstMeet/Vuex-And-V-Model.html" class="sidebar-link">vuex 和 v-model</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>关于我自己学习的 Webpack</span><!----></p><ul class="sidebar-group-items"><li><a href="/xiaokedada/FirstMeet/Webpack-With-Tool.html" class="sidebar-link">Webpack 可视化工具</a></li><li><a href="/xiaokedada/FirstMeet/Webpack-Operating-Principle.html" class="sidebar-link">从打包结果看 webpack 依赖管理</a></li><li><a href="/xiaokedada/FirstMeet/Webpack-JavaScript-Module-History.html" class="sidebar-link">JavaScript 模块化的发展进程</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Type System</span><!----></p><ul class="sidebar-group-items"><li><a href="/xiaokedada/FirstMeet/Type-System-ML.html" class="sidebar-link">数理逻辑理论</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="webpack基本配置"><a href="#webpack基本配置" aria-hidden="true" class="header-anchor">#</a> Webpack基本配置</h1><blockquote><p>来源：<a href="https://yuque.antfin-inc.com/kejun/xdnio4/tmllzq" target="_blank" rel="noopener noreferrer">Webpack基本配置<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><h2 id="章节简介"><a href="#章节简介" aria-hidden="true" class="header-anchor">#</a> 章节简介</h2><p><a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">Webpack<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 是目前最为流行的前端构建工具。同时在前端工程化中，Webpack在开发/编译/构建中都起到了最关键的作用。所以在当下阶段，webpack的基本配置，是每一个前端程序员应当掌握的基本技能。</p><p>2014年2月，Webpack发布了第一个正式版，而如今已经到了Webpack@4。Webpack版本变更似乎是参考了同行的一些功能。<a href="https://rollupjs.org/guide/en" target="_blank" rel="noopener noreferrer">Rollup<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 推出后，Webpack2通过UglifyJs实现了tree-shaking，Webpack3实现了作用域提升(scope-hosting)。而在<a href="https://parceljs.org/" target="_blank" rel="noopener noreferrer">Parcel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> 推出后，Webpack4也开始降低配置化。在这之前，用户需要引入大量插件来做构建优化，开发环境与生产环境还需要做不同配置。而Webpack4通过设置模式（mode），可以减少开发与生产环境的插件引入与相应逻辑。</p><p>所以鉴于此，本章节立足当下，主要介绍Webpack@4的基本配置。根据开发构建的不同流程环节与构建的不同需求，我将webpack基本配置分为如下几块介绍：</p><ol><li><p>基本配置</p></li><li><p>开发配置</p></li><li><p>构建配置</p></li><li><p>库开发相关</p></li></ol><p>由于搭建webpack工程，会涉及多个维度的相关配置。但分散的配置介绍又显得凌乱，故而我选择系统的介绍相关配置，方便大家阅读后上手。我会从最基础的开始讲，尽量让一个webpack小白，看完文章以后，能利用webpack搭建基本的前端工程。但是具体详细的配置，我不会穷举，因为无论文章怎么写，必定不如官方文档详实与及时。我不指望一篇文章会成为一本工具书，只希望本文可以告诉入门用户webpack的大致套路与某些场景下的配置情况。建议实际操作需要查阅配置时，还是要查阅此时官网的相应文档。</p><p><a name="w5nzno"></a></p><h2 id="配置前言"><a href="#配置前言" aria-hidden="true" class="header-anchor">#</a> 配置前言</h2><p>介绍配置之前，我们应该对webpack有个初始认识，不然对配置会缺乏一些基本概念。<a href="https://webpack.js.org/" target="_blank" rel="noopener noreferrer">官网<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>对自身有着明确定义：</p><blockquote><p>webpack 是一个模块打包器。它的主要目标是将 JavaScript 文件打包在一起，打包后的文件用于在浏览器中使用，但它也能够胜任转换(transform)、打包(bundle)或包裹(package)任何资源(resource or asset)。</p></blockquote><p>在开发web应用时，假如我们没有任何构建工具。我们一开始会编写一个index.html 、index.js、index.less。随着功能的增多，我们的代码开始变的复杂、甚至可能会引用一些开源的库或者框架，这不可避免的要将代码拆分成模块，然后模块之间可能会有依赖。怎么管理不同模块的依赖引入、又如何打包和输出就成了一个大问题。</p><p>但不管模块如何多，开发人员总要先编写一个最初始的js文件。webpack就以这个初始js文件为「入口」，根据代码中声明的模块引用来加载其他资源文件，根据webpack配置来对加载的模块进行编译、打包，最终「输出」开发人员期望的打包结果。</p><p>（不同于webpack，另一款打包工具<a href="https://parceljs.org/" target="_blank" rel="noopener noreferrer">Parcel<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>更倾向于用html作为打包的入口文件）。</p><p><a name="e6cduw"></a></p><h2 id="基本配置"><a href="#基本配置" aria-hidden="true" class="header-anchor">#</a> 基本配置</h2><p><a name="tl3qzg"></a></p><h3 id="入口-entry"><a href="#入口-entry" aria-hidden="true" class="header-anchor">#</a> 入口[entry]</h3><p>从上节中，我们明白了「入口」的意义。一个webpack工程，首先至少要有一个入口，配置也很简单，官网有介绍：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token string">'./index.js'</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>当然，因为工程可能是多个HTML页面的，每个页面都希望有各自的入口，那可能就是这样：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    pageA<span class="token punctuation">:</span> <span class="token string">'./pageA.js'</span><span class="token punctuation">,</span>
    pageB<span class="token punctuation">:</span> <span class="token string">'./pageB.js'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>entry也可以为数组，如：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./fileA.js'</span><span class="token punctuation">,</span> <span class="token string">'./fileB.js'</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token comment">// 也可以这样：</span>
module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    main<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'./fileA.js'</span><span class="token punctuation">,</span> <span class="token string">'./fileB.js'</span><span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这样配置后会将多个js文件，最终打包成一个入口。数组型的入口，在工程开发中使用较少。某些插件可能会利用此特性来实现一些功能，如往入口中注入热更新相关代码以实现热更新[HMR]。</p><p><a name="ieehgm"></a></p><h3 id="出口-output"><a href="#出口-output" aria-hidden="true" class="header-anchor">#</a> 出口[output]</h3><p>我们所定义的「入口」是开发时的程序入口，最终编译构建后，真正被浏览器加载的资源文件则是「出口」文件。「出口」的相关配置定义了输出文件的路径与文件名。最基本的配置为：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'output.js'</span><span class="token punctuation">,</span> <span class="token comment">// 文件名</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span> <span class="token comment">// 文件输出路径，必须为系统绝对路径</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>由于「入口」会存在多个，同样的「出口」文件也会有多个，多出口的定义如下：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    pageA<span class="token punctuation">:</span> <span class="token string">'./a.js'</span><span class="token punctuation">,</span>
    pageB<span class="token punctuation">:</span> <span class="token string">'./b.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这样配置后，将会输出 <code>/dist/pageA.js</code> 与 <code>/dist/pageB.js</code> 。占位符 <code>[name]</code> 为 <code>chunkName</code> ，在此处则即是 entry 中多入口配置对象的key值，即pageA 与 pageB。</p><p><a name="q5sstl"></a></p><h4 id="chunk"><a href="#chunk" aria-hidden="true" class="header-anchor">#</a> chunk</h4><p>在这里又引入了一个 <code>chunk</code> 的概念。<code>chunk</code> 的中文意思是“块”，在这里即是代码块。我们可以将一个webpack打包出的一个js文件认为是一个chunk 。如果我们不做任何的拆包处理，那我们的每一个entry就会输出一个chunk。output的filename的配置中，占位符即代表了chunk的一些属性。如[id]代表chunkId，[chunkhash]代表chunk文件的内容哈希值。当然 <code>filename</code> 也可以配置为函数，函数入参则为包含chunk信息的对象。</p><p><a name="x98oue"></a></p><h4 id="path与publicpath"><a href="#path与publicpath" aria-hidden="true" class="header-anchor">#</a> path与publicPath</h4><p><code>path</code> 配置决定了最终打包后输出资源的文件路径，且它必须要求为系统绝对路径（这不等同于html中最终引入的路径）。如果使用了html插件（这在后续章节会讲到），那webpack会智能的判断生成的html与chunk的相对路径，再以script方式引入。</p><p>有时候我们html与静态资源并非分发到同一个地方。如html为服务端渲染输出、亦或者发至专门的html输出服务器以便方便控制版本，而js/css等静态资源则专门分发到cdn。这样就需要html中引入资源时以完整路径引入。这时就需要用使用 <code>publicPath</code> ，如：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token keyword">const</span> HtmlWebpackPlugin <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'html-webpack-plugin'</span><span class="token punctuation">)</span>

module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  entry<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    pageA<span class="token punctuation">:</span> <span class="token string">'./a.js'</span><span class="token punctuation">,</span>
    pageB<span class="token punctuation">:</span> <span class="token string">'./b.js'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  output<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    filename<span class="token punctuation">:</span> <span class="token string">'[name].js'</span><span class="token punctuation">,</span>
    path<span class="token punctuation">:</span> __dirname <span class="token operator">+</span> <span class="token string">'/dist'</span><span class="token punctuation">,</span>
    publicPath<span class="token punctuation">:</span> <span class="token string">'https://cdn.antfin.com'</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
  plugins<span class="token punctuation">:</span> <span class="token punctuation">[</span>
    <span class="token keyword">new</span> <span class="token class-name">HtmlWebpackPlugin</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">]</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>这样，html中引用的js资源从 <code>pageA.js</code>  变为 <code>https://cdn.antfin.com/pageA.js</code> 。</p><p>还有一种常见的情况是“按需加载”。这时js资源会异步的去加载，而不是直接以script资源方式构建在html文件中。这种情况下，webpack无法判断js与html的相对路径（因为这是在js文件中执行脚本引入的，这个js文件也可能被不同的页面引入，不确定此时具体的html文件与其路径）。所以，需要配置 <code>publicPath</code> 固化此 <code>异步chunk</code> 的地址。</p><p><a name="9crgbd"></a></p><h4 id="其他"><a href="#其他" aria-hidden="true" class="header-anchor">#</a> 其他</h4><p><code>output</code> 还有个很重要的配置属性是 <code>library</code> ，这个属性决定了webpack构建出来的包是做什么用途的，能被以何种方式引用、加载执行。但对于日常工程构建来说，可以默认不配置。后续在 **「库开发相关」**这一章节中，我会再具体介绍。</p><p>除此外，output还有非常多的配置，但都比较偏门，同学们可以在输出文件遇到问题时，查询官方文档。</p><p><a name="8hyefb"></a></p><h3 id="模式-mode"><a href="#模式-mode" aria-hidden="true" class="header-anchor">#</a> 模式[mode]</h3><p>模式是webpack@4新增的配置属性，目的是为了简化webpack繁琐的配置。上两节中我们介绍了文件的入口与输出。在一个工程化的项目中：生产环境下，我们希望输出的文件是经过压缩、混淆（丑化）的。而开发环境时由于调试需要，我们希望文件是未压缩与混淆的。</p><p>在webpack@4以前，我们往往通过执行不同的npm script命令，从而设置不同的process.env.NODE_ENV，进而在webpack配置文件中判断此时环境变量，加载不同的webpack插件，输出不同的配置。</p><p>由于大部分工程项目的开发环境与生产环境有着较为统一的需求，因此webpack@4+通过配置不同模式[mode]，来默认执行该模式下的一些通用操作。如生产模式时，默认引入代码压缩混淆插件 <code>UglifyJsPlugin</code> 与作用域提升的插件 <code>ModuleConcatenationPlugin</code> 。</p><p>目前已有的模式有：<code>production</code> 、<code>development</code> 、<code>none</code> ，默认为<code>production</code>。设置为 <code>production</code> 与 <code>development</code> 时会同时默认设置process.env.NODE_ENV为production或development。 设置 <code>none</code> 时，webpack不做任何附加操作。</p><p><a name="pud9ql"></a></p><h3 id="模块-module"><a href="#模块-module" aria-hidden="true" class="header-anchor">#</a> 模块[module]</h3><p>我们知道webpack 是一个模块打包器，它不仅仅能处理js文件，还能处理css、图片。而且也能将ES6的代码、甚至是TypeScript的代码引用并打包输出成当下可执行的js文件。而webpack自身不可能穷举处理所有的相关文件。于是就采用了 <code>loader</code> 方式。</p><blockquote><p>loader 用于对模块的源代码进行转换。loader 可以使你在 import 或 &quot;加载&quot; 模块时预处理文件。</p></blockquote><p>不同的文件类型可能需要匹配不同的loader，做不同的文件转化。而有的模块可能需要处理，有的模块可能需要忽略，这一切相关的配置就在 <code>module</code>** **中。</p><p><a name="l7emso"></a></p><h4 id="rules"><a href="#rules" aria-hidden="true" class="header-anchor">#</a> rules</h4><p><code>module</code> 的主要配置项为 <code>rules</code> 。这是一个数组配置，rules中的每一项rule即配置了如何去处理一个模块。比如我们希望将ES6代码转成ES5代码，这需要引用 <code>babel-loader</code> 。它的rule配置即为：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token comment">//...</span>
  module<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    rules<span class="token punctuation">:</span> <span class="token punctuation">[</span>
      <span class="token punctuation">{</span>
        test<span class="token punctuation">:</span> <span class="token regex">/\.(js)$/</span><span class="token punctuation">,</span>
        use<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span>
      <span class="token punctuation">}</span>
    <span class="token punctuation">]</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div><p>其中 <code>test</code> 可以为一个正则，其匹配的对象是 引用模块的绝对路径，我们通过配置上述配置将所有引入的js文件都通过babel-loader来转化。</p><p>作为loader，可能需要一些额外的配置，比如 <code>babel-loader</code> 可能需要做一些编译配置，来设置最终转化后的结果。这需要 <code>use</code> 属性值为对象，不可简写为字符串，如：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  test<span class="token punctuation">:</span> <span class="token regex">/\.(js)$/</span><span class="token punctuation">,</span>
  use<span class="token punctuation">:</span> <span class="token punctuation">{</span>
    loader<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
    options<span class="token punctuation">:</span> <span class="token punctuation">{</span>
      presets<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">'@babel/preset-env'</span><span class="token punctuation">]</span> <span class="token comment">// 根据目标浏览器自动转换为相应es5代码</span>
    <span class="token punctuation">}</span> 
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
<span class="token comment">// ps: babel的配置我们更多是以.babelrc配置文件的方式存在项目根目录</span>
</code></pre></div><p>一般来说，node_modules中我们加载的外部库文件已经被babel编译成es5代码，因此是不需要再进行一次babel编译的。为了节省开发、构建性能，我们会通过配置 <code>exclude</code> 或 <code>include</code> 来过滤或者指定需要执行loader的文件目录。如：</p><div class="language-javascript extra-class"><pre class="language-javascript"><code><span class="token punctuation">{</span>
  test<span class="token punctuation">:</span> <span class="token regex">/\.(js)$/</span><span class="token punctuation">,</span>
  use<span class="token punctuation">:</span> <span class="token string">'babel-loader'</span><span class="token punctuation">,</span>
  exclude<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'./node_modules'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">// 过滤node_modules目录</span>
  include<span class="token punctuation">:</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>process<span class="token punctuation">.</span><span class="token function">cwd</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'./src'</span><span class="token punctuation">)</span> <span class="token comment">// 只匹配src目录</span>
<span class="token punctuation">}</span>
</code></pre></div><p>有时候，我们一个模块文件需要转化多次，需要多个loader。比如一个css文件，先通过 <code>css-loader</code> 解释css文件内的 <code>@import</code> 和 <code>url()</code> ， 最后通过 <code>style-loader</code> 将css以</p><style></style></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/maoxiaoke/xiaokedada/edit/master/FirstMeet/Webpack-Basic.md" target="_blank" rel="noopener noreferrer">在 Github 上编辑此页</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><div class="last-updated"><span class="prefix">上次更新: </span><span class="time">11/17/2019, 11:34:52 AM</span></div></div><!----></div></div></div>
    <script src="/xiaokedada/assets/js/76.f1760c70.js" defer></script><script src="/xiaokedada/assets/js/app.51d0a681.js" defer></script>
  </body>
</html>
