<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>万物皆不同 - Symbols | XIAOKEDADA</title>
    <meta name="description" content="Write something useful and funny">
    <link rel="icon" href="/favicon.png">
    
    <link rel="preload" href="/assets/css/68.styles.d3eb3505.css" as="style"><link rel="preload" href="/assets/js/app.843b634b.js" as="script"><link rel="preload" href="/assets/js/24.8ed99de7.js" as="script"><link rel="prefetch" href="/assets/js/35.fc0649b6.js"><link rel="prefetch" href="/assets/js/1.85421567.js"><link rel="prefetch" href="/assets/js/2.f423fd68.js"><link rel="prefetch" href="/assets/js/3.1f142fb1.js"><link rel="prefetch" href="/assets/js/4.bd68aee8.js"><link rel="prefetch" href="/assets/js/5.0a465bdb.js"><link rel="prefetch" href="/assets/js/6.97e629f1.js"><link rel="prefetch" href="/assets/js/7.bb19bdef.js"><link rel="prefetch" href="/assets/js/8.5daef4ca.js"><link rel="prefetch" href="/assets/js/9.4fcb0f34.js"><link rel="prefetch" href="/assets/js/10.4376478b.js"><link rel="prefetch" href="/assets/js/11.8fc6b13a.js"><link rel="prefetch" href="/assets/js/12.1772ec65.js"><link rel="prefetch" href="/assets/js/13.a4ef0e77.js"><link rel="prefetch" href="/assets/js/14.427f03c9.js"><link rel="prefetch" href="/assets/js/15.723a7d06.js"><link rel="prefetch" href="/assets/js/16.166d836c.js"><link rel="prefetch" href="/assets/js/17.21b4f630.js"><link rel="prefetch" href="/assets/js/18.fd756ec4.js"><link rel="prefetch" href="/assets/js/19.a8b80d16.js"><link rel="prefetch" href="/assets/js/20.8e9cdb67.js"><link rel="prefetch" href="/assets/js/21.4e4f2b91.js"><link rel="prefetch" href="/assets/js/22.d28267a3.js"><link rel="prefetch" href="/assets/js/23.653fa423.js"><link rel="prefetch" href="/assets/js/25.614045fd.js"><link rel="prefetch" href="/assets/js/26.02791f7a.js"><link rel="prefetch" href="/assets/js/27.3fa3f1e9.js"><link rel="prefetch" href="/assets/js/28.8aaaacba.js"><link rel="prefetch" href="/assets/js/29.02e1b211.js"><link rel="prefetch" href="/assets/js/30.46e3e02b.js"><link rel="prefetch" href="/assets/js/31.8af56ad3.js"><link rel="prefetch" href="/assets/js/32.091d8ef1.js"><link rel="prefetch" href="/assets/js/33.d33fb871.js"><link rel="prefetch" href="/assets/js/34.d41761e9.js"><link rel="prefetch" href="/assets/js/0.e6be7c2e.js"><link rel="prefetch" href="/assets/js/36.d0053b92.js"><link rel="prefetch" href="/assets/js/37.21574b04.js"><link rel="prefetch" href="/assets/js/38.80e207ae.js"><link rel="prefetch" href="/assets/js/39.e4995ccf.js"><link rel="prefetch" href="/assets/js/40.5d361e67.js"><link rel="prefetch" href="/assets/js/41.a50cd60b.js"><link rel="prefetch" href="/assets/js/42.caf66f0e.js"><link rel="prefetch" href="/assets/js/43.4a9eaf80.js"><link rel="prefetch" href="/assets/js/44.448792e0.js"><link rel="prefetch" href="/assets/js/45.a2c7b618.js"><link rel="prefetch" href="/assets/js/46.d5711dfe.js"><link rel="prefetch" href="/assets/js/47.b7c59a32.js"><link rel="prefetch" href="/assets/js/48.d54390f0.js"><link rel="prefetch" href="/assets/js/49.0e14e323.js"><link rel="prefetch" href="/assets/js/50.116c6f8c.js"><link rel="prefetch" href="/assets/js/51.00a2e7ea.js"><link rel="prefetch" href="/assets/js/52.96b8f0e2.js"><link rel="prefetch" href="/assets/js/53.6316d91b.js"><link rel="prefetch" href="/assets/js/54.3120e195.js"><link rel="prefetch" href="/assets/js/55.7582a732.js"><link rel="prefetch" href="/assets/js/56.eab8bc2a.js"><link rel="prefetch" href="/assets/js/57.74edb44a.js"><link rel="prefetch" href="/assets/js/58.5122e2dc.js"><link rel="prefetch" href="/assets/js/59.3ec0162a.js"><link rel="prefetch" href="/assets/js/60.8ec70531.js"><link rel="prefetch" href="/assets/js/61.fc7a010b.js"><link rel="prefetch" href="/assets/js/62.e17877aa.js"><link rel="prefetch" href="/assets/js/63.44b0382a.js"><link rel="prefetch" href="/assets/js/64.621d7404.js"><link rel="prefetch" href="/assets/js/65.755ec884.js"><link rel="prefetch" href="/assets/js/66.bfb5a72d.js"><link rel="prefetch" href="/assets/js/67.b71bf6f3.js">
    <link rel="stylesheet" href="/assets/css/68.styles.d3eb3505.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div><a href="/" class="home-link router-link-active"><!----><span class="site-name">
      XIAOKEDADA
    </span></a><div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""><!----></div><nav class="nav-links can-hide"><div class="nav-item"><a href="/JavaScript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/FirstMeet/" class="nav-link">FirstMeet系列</a></div><div class="nav-item"><a href="/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/ReadingNote/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/GatherAll/" class="nav-link">R &amp; T</a></div><a href="https://github.com/maoxiaoke/xiaokedada" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header><div class="sidebar-mask"></div><div class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/JavaScript/" class="nav-link router-link-active">JavaScript</a></div><div class="nav-item"><a href="/FirstMeet/" class="nav-link">FirstMeet系列</a></div><div class="nav-item"><a href="/CSS/" class="nav-link">CSS</a></div><div class="nav-item"><a href="/ReadingNote/" class="nav-link">读书笔记</a></div><div class="nav-item"><a href="/GatherAll/" class="nav-link">R &amp; T</a></div><a href="https://github.com/maoxiaoke/xiaokedada" target="_blank" rel="noopener noreferrer" class="repo-link">
    Github
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav><ul class="sidebar-links"><li><div class="sidebar-group first"><p class="sidebar-heading"><span>Depth-in-Series</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/Require-and-Import.html" class="sidebar-link">require 和 import 的难点</a></li><li><a href="/JavaScript/Property-Descriptors.html" class="sidebar-link">JavaScript 对象的 Property descriptors</a></li><li><a href="/JavaScript/Depth-in-ES6.html" class="sidebar-link">深入理解 ES6</a></li><li><a href="/JavaScript/Depth-in-This.html" class="sidebar-link">this 的挑战</a></li><li><a href="/JavaScript/Depth-in-Closure.html" class="sidebar-link">来一次痛痛快快得闭包挑战</a></li><li><a href="/JavaScript/Async-Programming.html" class="sidebar-link">JavaScript 异步编程</a></li><li><a href="/JavaScript/Prototype.html" class="sidebar-link">再谈原型和继承</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading open"><span>Re-learn ES6</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/ES6-Let-and-Const.html" class="sidebar-link">最佳实践，使用 let/const</a></li><li><a href="/JavaScript/ES6-Class.html" class="sidebar-link">近似 Class 的操作</a></li><li><a href="/JavaScript/ES6-Symbols.html" class="active sidebar-link">万物皆不同 - Symbols</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#symbols-是针对什么提出来的方案" class="sidebar-link">Symbols 是针对什么提出来的方案</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#symbol-属性的匿名性" class="sidebar-link">Symbol 属性的匿名性</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#symbol-的特异性" class="sidebar-link">Symbol 的特异性</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#symbol-的额外参数" class="sidebar-link">Symbol 的额外参数</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#symbol-的分类" class="sidebar-link">Symbol 的分类</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#local-symbols" class="sidebar-link">Local Symbols</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#global-symbol-registry-和-sharing-symbols" class="sidebar-link">Global Symbol Registry 和 Sharing Symbols</a></li><li class="sidebar-sub-header"><a href="/JavaScript/ES6-Symbols.html#well-known-symbols" class="sidebar-link">Well-Known Symbols</a></li></ul></li></ul></li><li><a href="/JavaScript/ES6-Iterator-And-Iterable.html" class="sidebar-link">迭代协议</a></li><li><a href="/JavaScript/ES6-Async.html" class="sidebar-link">异步编程要点</a></li><li><a href="/JavaScript/ES6-Generator.html" class="sidebar-link">Generator</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Light FP</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/Light-FP-Overview.html" class="sidebar-link">Light-FP 概念篇</a></li><li><a href="/JavaScript/Light-FP-Categries.html" class="sidebar-link">范畴学基础理论</a></li><li><a href="/JavaScript/Light-FP-Compose.html" class="sidebar-link">Compose</a></li><li><a href="/JavaScript/Light-FP-Container-And-Functor.html" class="sidebar-link">Container and Functor</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>基础内容</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/AJAX.html" class="sidebar-link">AJAX</a></li><li><a href="/JavaScript/Coercion.html" class="sidebar-link">强制类型转换</a></li><li><a href="/JavaScript/Map-and-Reduce.html" class="sidebar-link">JavaScript 的 map/reduce</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>DOM 相关</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/DOM-Operation.html" class="sidebar-link">原生JavaScript的DOM操作</a></li><li><a href="/JavaScript/DOM-More.html" class="sidebar-link">再来仔细研究DOM</a></li><li><a href="/JavaScript/DOM-History.html" class="sidebar-link">和 URL 相关的 Location 和 History</a></li></ul></div></li><li><div class="sidebar-group"><p class="sidebar-heading"><span>Thinking-in-JavaScript</span><!----></p><ul class="sidebar-group-items"><li><a href="/JavaScript/Small-and-Chunk-Code.html" class="sidebar-link">书写有用而优雅的代码</a></li><li><a href="/JavaScript/I-Dont-Know-JavaScript.html" class="sidebar-link">你看到的 JavaScript，并不是真实的</a></li><li><a href="/JavaScript/Refactor-JavaScript.html" class="sidebar-link">有关代码重构和整洁之道</a></li><li><a href="/JavaScript/JavaScript-Design-Pattern.html" class="sidebar-link">设计模式</a></li></ul></div></li></ul></div><div class="page"><div class="content"><h1 id="万物皆不同-symbols"><a href="#万物皆不同-symbols" aria-hidden="true" class="header-anchor">#</a> 万物皆不同 - Symbols</h1><p>TODO:</p><ul><li>[ ] Symbols 是真的针对 <em>private object member</em> 提出的方案，还有一种说法是第三方库的冲突（增加这部分内容）。</li><li>[ ] 对于第二种，有什么实际例子可以提供什么例子</li></ul><h2 id="symbols-是针对什么提出来的方案"><a href="#symbols-是针对什么提出来的方案" aria-hidden="true" class="header-anchor">#</a> Symbols 是针对什么提出来的方案</h2><p>即，回答为什么。</p><blockquote><p>The data type &quot;symbol&quot; is a primitive data type having the quality that, values of this type can be used to make object properties that are anonymous. This data type is used as the key for an object property when the property is intended to be private, for the internal use of a class or an object type. - <a href="https://developer.mozilla.org/en-US/docs/Glossary/Symbol" target="_blank" rel="noopener noreferrer">Symbol MDN<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></p></blockquote><p>在 Nicholas C.Zakes 的书中也表达了这样的一个观点。</p><blockquote><p>Symbols began as a way to create private object members.</p></blockquote><p>在 Symbols 之前，对象的属性都可以直接访问到。为了构建私有属性，开发者通常在属性名前加 <code>_</code> 来约定该属性为对象私有。但是，我们仍然可以访问到该属性或者修改属性值。</p><p>Symbols 改变了这一切。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> firstName <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>firstName<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'xiaoke'</span> <span class="token comment">// 可写的 firstName symbol 属性</span>
<span class="token punctuation">}</span>
<span class="token comment">// 或者，使用 Object.defineProperties</span>
<span class="token keyword">let</span> lastName <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'mao'</span><span class="token punctuation">)</span>
Object<span class="token punctuation">.</span><span class="token function">defineProperties</span><span class="token punctuation">(</span>person<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>lastName<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token punctuation">{</span>
        value<span class="token punctuation">:</span> <span class="token string">'mao'</span><span class="token punctuation">,</span>
        writable<span class="token punctuation">:</span> <span class="token string">'false'</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token comment">// 只读的 lastName symbol 属性</span>
</code></pre></div><p>Symbols 的另一个用处是提供了一些 <code>well-known Symbol</code> 来实现 JavaScript 的一些协议。比如通过 <code>Symbol.iterator</code> 实现了 <em>iterator protocol</em>（我们之后学习的很多内容，都有 Symbol 的身影）。</p><h2 id="symbol-属性的匿名性"><a href="#symbol-属性的匿名性" aria-hidden="true" class="header-anchor">#</a> Symbol 属性的匿名性</h2><p>正因为 Symbol 属性是匿名的。诸如 <code>for...in</code>、<code>Object.keys</code>、<code>Object.getOwnPropertyNames</code> 都无法得到 symbol 定义的属性名。</p><ul><li><code>for...in</code> 会遍历对象自身和原型链上的可枚举属性</li><li><code>Object.keys</code> 只遍历对象自身的可枚举属性</li><li><code>Object.getOwnPropertyNames</code> 遍历对象自身的所有属性</li></ul><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> person<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token comment">// undefined</span>
<span class="token punctuation">}</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">keys</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// []</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>Object<span class="token punctuation">.</span><span class="token function">getOwnPropertyNames</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// []</span>
</code></pre></div><p>当然，<code>JSON.stringify()</code> 也对 Symbol 属性一无所知。</p><div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token comment">// &quot;{}&quot;</span>
</code></pre></div><p>Instead，ES6 提供了 <code>Object.getOwnPropertySymbols()</code> 来取得 Symbol 属性。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> symbols <span class="token operator">=</span> Object<span class="token punctuation">.</span><span class="token function">getOwnPropertySymbols</span><span class="token punctuation">(</span>person<span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>symbols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(xiaoke)&quot;</span>
person<span class="token punctuation">[</span>symbols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'yuer'</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>person<span class="token punctuation">[</span>symbols<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token comment">// 'yuer'</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>很好奇是不是，本来希望通过 Symbol 给对象提供私有属性。但 <code>Object.getOwnPropertySymbols()</code> 又提供了我们访问 Symbol 属性的能力，不解。</p></div><h2 id="symbol-的特异性"><a href="#symbol-的特异性" aria-hidden="true" class="header-anchor">#</a> Symbol 的特异性</h2><p>在我们的所有 <code>Primitive types</code> 中，Symbol 的设计有着非常明显的刻意性。比如，得到一个 Symbol实例，<code>Symbol('xxx')</code> 是正确的，而 <code>new Symbol('xxx')</code> 则是错误的。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> xiaoke <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span> <span class="token comment">// right</span>

<span class="token keyword">let</span> xiaoke <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span> <span class="token comment">// Uncaught TypeError: Symbol is not a constructor</span>
</code></pre></div><p>在比如，如果我们想对 Symbol 进行强制的类型转换，这亦是不可能的。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> xiaoke <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>
    xiaokedada <span class="token operator">=</span> xiaoke <span class="token operator">+</span> <span class="token string">'dada'</span> <span class="token comment">// Uncaught TypeError: Cannot convert a Symbol value to a string</span>
</code></pre></div><div class="warning custom-block"><p class="custom-block-title">WARNING</p><p>又有了一个好奇点对不对，当我们：</p><div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>xiaoke<span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(xiaoke)&quot;</span>
</code></pre></div><p>这是因为我们有一个内部抽象方法 <code>toString()</code> 和 <code>String()</code> 的效果一样。</p><div class="language-js extra-class"><pre class="language-js"><code>xiaoke<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(xiaoke)&quot;</span>
<span class="token function">String</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;Symbol(xiaoke)&quot;</span>
</code></pre></div><p>如果是一个 <em>简单对象</em> 在进行强制类型转换的时候，会强制对 <em>简单对象</em> 进行 <code>toString()</code>：</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span>
<span class="token keyword">let</span> te <span class="token operator">=</span> obj <span class="token operator">+</span> <span class="token string">'dada'</span> <span class="token comment">// &quot;[object Object]dada&quot;</span>
</code></pre></div><p>但是到了 Symbol 这，它偏不。这是不是完全可以说明在设计 Symbol 时的刻意性。</p></div><p>也就是说，对于 Symbol 而言：<strong>一个 Symbol 的实例赋值给一个 L-value， 然后用来表明它的特异性，无他</strong>。</p><p>最开始的这个简单例子完美地解释了上面这句话：</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> firstName <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> person <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token punctuation">[</span>firstName<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token string">'xiaoke'</span> <span class="token comment">// 可写的 firstName symbol 属性</span>
<span class="token punctuation">}</span>
</code></pre></div><p>为了构建一个对象的私有属性，我们用 <code>Symbol('xiaoke')</code> 返回一个实例赋值给 <code>firstName</code>，并作为对象 <code>person</code> 的一个属性。也就是说，<code>Symbol('xiaoke')</code> 为对象 <code>person</code> 构建了一个独一无二的属性。</p><h2 id="symbol-的额外参数"><a href="#symbol-的额外参数" aria-hidden="true" class="header-anchor">#</a> Symbol 的额外参数</h2><p>构造函数 <code>Symbol</code> 可以接收一个额外的参数，用来描述这个 Symbol 实例。这个额外的参数没有很多设计上的函数，其目的只是便于 Symbol 的调试。</p><h2 id="symbol-的分类"><a href="#symbol-的分类" aria-hidden="true" class="header-anchor">#</a> Symbol 的分类</h2><p>根据 Symbol 的不同用处，可以将 Symbol 分为 Local Symbols、Global Symbol Registry 和 <em>Well-Known</em> Symbols。</p><h3 id="local-symbols"><a href="#local-symbols" aria-hidden="true" class="header-anchor">#</a> Local Symbols</h3><p>我们在上面提到的大部分内容，都属于 Local Symbols。使用 <code>Symbol</code> 构造函数进行构造。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> xiaoke <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span>'xiaoke<span class="token punctuation">)</span>
</code></pre></div><h3 id="global-symbol-registry-和-sharing-symbols"><a href="#global-symbol-registry-和-sharing-symbols" aria-hidden="true" class="header-anchor">#</a> Global Symbol Registry 和 Sharing Symbols</h3><p>这种类型的 Symbols 是通过 <code>Symbol.for()</code> 来构造的。因为有些开发环境下，symbol 需要在多个 realm 共享，比如 iframe、web worker 都有自己的全局对象。Global Symbol Registry 使得生成的 Symbol 可以在多个 realm 共享。</p><p><code>Symbol.for()</code> 首先会查询该 symbol 是否在 Global Symbol Registry 注册，如果存在，会直接使用该 symbol；否则，注册该 symbol。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> xiaoke <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> xiaokedada <span class="token operator">=</span> <span class="token function">Symbol</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>

xiaoke <span class="token operator">===</span> xiaokedada <span class="token comment">// false</span>

<span class="token keyword">let</span> xiaoke <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>
<span class="token keyword">let</span> xiaokedada <span class="token operator">=</span> Symbol<span class="token punctuation">.</span><span class="token keyword">for</span><span class="token punctuation">(</span><span class="token string">'xiaoke'</span><span class="token punctuation">)</span>

xiaoke <span class="token operator">===</span> xiaokedada <span class="token comment">// true</span>
</code></pre></div><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>Symbol.keyFor()</code> 用来取回 Global Symbol Registry 中注册的 symbol，如果 Global Symbol Registry 没有注册，则返回 <code>undefined</code>。</p><div class="language-js extra-class"><pre class="language-js"><code>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">'Symbol.keyFor(xiaokedada)'</span><span class="token punctuation">)</span> <span class="token comment">// &quot;xiaoke&quot;</span>
</code></pre></div></div><h3 id="well-known-symbols"><a href="#well-known-symbols" aria-hidden="true" class="header-anchor">#</a> Well-Known Symbols</h3><p>ES6 还实现了一些内置的用于实现某些语言特性，而非提供给开发者使用的 Symbols。通过这些 <em>钩子</em>, 开发者扩展或者自定义一些语法规则。</p><p>有这么一些：</p><ul><li><code>Symbol.hasInstance</code> - 用于 instanceof 的实现</li><li><code>Symbol.isConcatSpreadable</code></li><li><code>Symbol.iterator</code> 返回一个 iterator</li><li><code>Symbol.match</code>、<code>Symbol.replace</code>、<code>Symbol.search</code>、<code>Symbol.split</code> - 用于 String 的 match/replace/search/split 操作。</li><li><code>Symbol.species</code></li><li><code>Symbol.toPrimitive</code> - 用于对象返回 primitive 值</li><li><code>Symbol.toStringTag</code> - 用于 <code>Object.prototype.toSting</code> 返回对于对象的描述</li><li><code>Symbol.unscopables</code></li></ul><p>举些例子：<code>Symbol.hasInstance</code> 和 <code>Symbol.isConcatSpreadable</code>。</p><p><strong><code>Symbol.hasInstance</code></strong></p><p>ES6 重新定义了 <code>instanceof</code>。</p><div class="language-js extra-class"><pre class="language-js"><code>obj <span class="token keyword">instanceof</span> <span class="token class-name">Array</span>

<span class="token comment">// 等价于</span>
Array<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">]</span><span class="token punctuation">(</span>obj<span class="token punctuation">)</span>
</code></pre></div><p>比如：</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">function</span> <span class="token function">CreateObj</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// ...</span>
<span class="token punctuation">}</span>
<span class="token keyword">let</span> obj <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">CreateObj</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">CreateObj</span><span class="token punctuation">)</span> <span class="token comment">// true</span>

Object<span class="token punctuation">.</span><span class="token function">defineProperty</span><span class="token punctuation">(</span>CreateObj<span class="token punctuation">,</span> Symbol<span class="token punctuation">.</span>hasInstance<span class="token punctuation">,</span> <span class="token punctuation">{</span>
    value<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span>v<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token boolean">false</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>obj <span class="token keyword">instanceof</span> <span class="token class-name">CreateObj</span><span class="token punctuation">)</span> <span class="token comment">// false</span>
</code></pre></div><p><strong><code>Symbol.isConcatSpreadable</code></strong></p><p>Symbol.isConcatSpreadable 用于判定当使用 <code>Array.prototype.concat()</code> 方法时，对象是否会被 flattened 成数组元素。默认为 <code>true</code>。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> alpha <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'a'</span><span class="token punctuation">,</span> <span class="token string">'b'</span><span class="token punctuation">,</span> <span class="token string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    numeric <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>
<span class="token keyword">let</span> alphaNumeric <span class="token operator">=</span> alpha<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>numeric<span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', 'c', 1, 2, 3]</span>

<span class="token comment">// 使用 Symbol.isConcatSpreadable</span>
numeric<span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">false</span>
alphaNumeric <span class="token operator">=</span> alpha<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>numeric<span class="token punctuation">)</span> <span class="token comment">// ['a', 'b', 'c', [1, 2, 3] ]</span>
</code></pre></div><p>另一个使用场景是我们可以利用 Symbol.isConcatSpreadable 对类数组的对象使用 <code>Array.prototype.concat()</code> 方法。</p><div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">let</span> x <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span>

<span class="token keyword">let</span> fakeArray <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>isConcatSpreadable<span class="token punctuation">]</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
  length<span class="token punctuation">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
  <span class="token number">0</span><span class="token punctuation">:</span> <span class="token string">'hello'</span><span class="token punctuation">,</span>
  <span class="token number">1</span><span class="token punctuation">:</span> <span class="token string">'world'</span>
<span class="token punctuation">}</span>
x<span class="token punctuation">.</span><span class="token function">concat</span><span class="token punctuation">(</span>fakeArray<span class="token punctuation">)</span> <span class="token comment">// [1, 2, 3, &quot;hello&quot;, &quot;world&quot;]</span>

</code></pre></div></div><div class="page-edit"><div class="edit-link"><a href="https://github.com/maoxiaoke/xiaokedada/edit/master/JavaScript/ES6-Symbols.md" target="_blank" rel="noopener noreferrer">在 Github 上编辑此页</a><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div><!----></div><div class="page-nav"><p class="inner"><span class="prev">
        ← <a href="/JavaScript/ES6-Class.html" class="prev">
          近似 Class 的操作
        </a></span><span class="next"><a href="/JavaScript/ES6-Iterator-And-Iterable.html">
          迭代协议
        </a> →
      </span></p></div></div></div></div>
    <script src="/assets/js/24.8ed99de7.js" defer></script><script src="/assets/js/app.843b634b.js" defer></script>
  </body>
</html>
